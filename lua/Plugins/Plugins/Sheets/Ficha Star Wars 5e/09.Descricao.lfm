<?xml version="1.0" encoding="UTF-8"?>
<form name="frmFichaRPGmeister9_svg" align="client" theme="dark" margins="{top=1}">
	<scrollBox align="client">
		<template name="Descricao">
			<label left="$(left1)" top="$(top)" width="90" height="20" text="$(text)" horzTextAlign="center"/>
			<edit left="$(left2)" top="$(top)" width="200" height="25" field="$(field)" vertTextAlign="center" />
		</template>
		
		<rectangle left="0" top="0" width="1205" height="105" color="black">
			<label left="3" top="1" width="100" height="20" text="DESCRIÇÃO"/>
		
			<label left="10" top="25" width="90" height="20" text="TAMANHO" horzTextAlign="center"/>
			<comboBox left="100" top="25" width="100" field="tamanho" fontColor="white" items="{'Minúsculo', 'Diminuto', 'Miúdo', 'Pequeno', 'Médio', 'Grande', 'Enorme', 'Imenso', 'Colossal'}" values="{'-4','-3','-2','-1','0','1','2','3','4'}" horzTextAlign="center"/>
			<checkBox left="200" top="25" width="100" field="quadrupede" text="Quadrúpede" />
			<Descricao left1="10" left2="100" top="50" text="ALTURA" field="altura"/>
			<Descricao left1="10" left2="100" top="75" text="PESO" field="peso"/>
			
			<Descricao left1="310" left2="400" top="25" text="IDADE" field="idade"/>
			<Descricao left1="310" left2="400" top="50" text="SEXO" field="sexo"/>
			<Descricao left1="310" left2="400" top="75" text="OUTROS" field="aparenciaOutros"/>
			
			<Descricao left1="610" left2="700" top="25" text="OLHOS" field="aparenciaOlhos"/>
			<Descricao left1="610" left2="700" top="50" text="PELE" field="pele"/>
			<Descricao left1="610" left2="700" top="75" text="CABELO" field="cabelo"/>
			
			<Descricao left1="910" left2="1000" top="25" text="PLANO" field="plano"/>
			<Descricao left1="910" left2="1000" top="50" text="REGIÃO" field="regiao"/>
			<Descricao left1="910" left2="1000" top="75" text="REINO" field="reino"/>
		</rectangle>

		<dataLink fields="{'tamanho', 'quadrupede', 'efetFor'}">
			<event name="onChange">
				<![CDATA[
				if sheet~=nil then
					local str = tonumber(sheet.efetFor) or 1;
					local size = tonumber(sheet.tamanho) or 0;
					local quad = sheet.quadrupede;

					local mult = 1;
					local mod1 = 0;
					local mod2 = 0;

					if size == -4 then
						if quad then
							mult = 1 / 4;
						else
							mult = 1 / 8;
						end;
						mod1 = 8;
						mod2 = 16;
					elseif size == -3 then
						if quad then
							mult = 1 / 2;
						else
							mult = 1 / 4;
						end;
						mod1 = 4;
						mod2 = 12;
					elseif size == -2 then
						if quad then
							mult = 3 / 4;
						else
							mult = 1 / 2;
						end;
						mod1 = 2;
						mod2 = 8;
					elseif size == -1 then
						if quad then
							mult = 1;
						else
							mult = 3 / 4;
						end;
						mod1 = 1;
						mod2 = 4;
					elseif size == 0 then
						if quad then
							mult = 1.5;
						else
							mult = 1;
						end;
					elseif size == 1 then
						if quad then
							mult = 3;
						else
							mult = 2;
						end;
						mod1 = -1;
						mod2 = -4;
					elseif size == 2 then
						if quad then
							mult = 6;
						else
							mult = 4;
						end;
						mod1 = -2;
						mod2 = -8;
					elseif size == 3 then
						if quad then
							mult = 12;
						else
							mult = 8;
						end;
						mod1 = -4;
						mod2 = -12;
					elseif size == 4 then
						if quad then
							mult = 24;
						else
							mult = 16;
						end;
						mod1 = -8;
						mod2 = -16;
					end;

					while str > 29 do
						mult = mult * 4;
						str = str - 10;
					end;

					if str < 1 then
						str = 1;
					end;

					local load = ndb.load("loads.xml");

					local light = (load.light[str] * mult);
					local medium = (load.medium[str] * mult);
					local heavy = (load.heavy[str] * mult);

					sheet.cargaLeve = light .. "Kg";
					sheet.cargaMedia = medium .. "Kg";
					sheet.cargaPesada = heavy .. "Kg";

					sheet.agarrarTam = 0 - mod2;
					sheet.tamanhoCa = mod1;
				end;
				]]>
			</event>	
		</dataLink>
		
		<layout left="0" top="110" width="375" height="240">
			<rectangle align="client" color="black"/>
			<label left="5" top="1" width="100" height="20" text="APARÊNCIA"/>
			<textEditor left="5" top="25" width="365" height="210" field="aparencia"/>
		</layout>
		<layout left="0" top="355" width="375" height="250">
			<rectangle align="client" color="black"/>
			<label left="5" top="1" width="100" height="20" text="PERSONALIDADE"/>
			<textEditor left="5" top="25" width="365" height="220" field="personalidade"/>
		</layout>
		<layout left="380" top="110" width="825" height="495">
			<rectangle align="client" color="black"/>
			<label left="5" top="1" width="100" height="20" text="HISTORIA"/>
			<button left="720" top="1" width="100" height="20" text="Copiar Antigo" onClick="System.setClipboardText(sheet.historia);"/>
			<richEdit left="5" top="25" width="815" height="465" field="background" backgroundColor="#333333" defaultFontSize="12" defaultFontColor="white"/>
		</layout>
	</scrollBox>
</form>
